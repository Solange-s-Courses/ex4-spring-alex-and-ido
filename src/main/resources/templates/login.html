<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/auth/auth-head :: head('Login')}"></head>
<body>
<div class="auth-container">
  <div class="auth-header">
    <h1 class="auth-title">Welcome Back</h1>
    <p class="auth-subtitle">Sign in to your account</p>
  </div>

  <!-- Display error message if login fails -->
  <div th:if="${param.error}" class="alert alert-error">Invalid email or password</div>

  <!-- Display logout success message -->
  <div th:if="${param.logout}" class="alert alert-success">You have been logged out successfully</div>

  <!-- NEW: Display registration success message -->
  <div th:if="${param.registered}" class="alert alert-success">Registration successful! You can now log in with your credentials.</div>

  <!-- NEW: Display any flash attribute success messages -->
  <div th:if="${success}" class="alert alert-success" th:text="${success}"></div>

  <!-- STEP 3: Updated form for Spring Security -->
  <form th:action="@{/login}" method="post" id="loginForm">
    <div class="form-group">
      <label for="username" class="form-label">Email Address</label>
      <input
              type="email"
              id="username"
              name="username"
              class="form-input"
              placeholder="Enter your email"
              required
              autocomplete="email"
              inputmode="email"
      >
    </div>

    <!-- Password field using fragment -->
    <div class="form-group">
      <label for="password" class="form-label">Password</label>
      <input
              type="password"
              id="password"
              name="password"
              class="form-input"
              placeholder="Enter your password"
              required
              autocomplete="current-password"
      >
    </div>

    <button type="submit" class="auth-button" id="loginBtn">
      Sign In
    </button>
  </form>

  <!-- Navigation using fragment -->
  <div th:replace="~{fragments/auth/auth-navigation :: navigation('Do not have an account?', 'Create new account', @{/register})}"></div>
</div>

<script th:src="@{/js/auth-scripts.js}"></script>
</body>
</html>