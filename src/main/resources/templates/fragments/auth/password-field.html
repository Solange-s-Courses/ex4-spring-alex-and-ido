<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>

<!-- Password Field Fragment -->
<!-- Parameters: fieldName, placeholder, autocompleteType, fieldValue, showValidation -->
<div th:fragment="passwordField(fieldName, placeholder, autocompleteType, fieldValue, showValidation)" class="form-group">
    <label th:for="${fieldName}" class="form-label">Password</label>
    <div class="password-field-container">
        <!-- Handle both Thymeleaf object binding and simple value binding -->
        <input th:if="${showValidation}"
               type="password"
               th:id="${fieldName}"
               th:name="${fieldName}"
               th:field="*{__${fieldName}__}"
               class="form-input password-input"
               th:classappend="${#fields.hasErrors(fieldName)} ? 'error' : ''"
               th:placeholder="${placeholder}"
               th:autocomplete="${autocompleteType}"
               required>

        <input th:unless="${showValidation}"
               type="password"
               th:id="${fieldName}"
               th:name="${fieldName}"
               class="form-input password-input"
               th:placeholder="${placeholder}"
               th:autocomplete="${autocompleteType}"
               th:value="${fieldValue}"
               required>

        <button type="button" class="password-toggle" id="passwordToggle" aria-label="Show password">
            SHOW
        </button>
    </div>

    <!-- Show validation errors only when showValidation is true -->
    <div th:if="${showValidation and #fields.hasErrors(fieldName)}" class="field-error">
        <span th:errors="*{__${fieldName}__}"></span>
    </div>

    <!-- Show help text only for register page -->
    <div th:if="${fieldName == 'password' and showValidation}" class="field-help">
        Password must be 8-16 characters with letters, numbers, and special characters (@$!%*?&)
    </div>
</div>

</body>
</html>